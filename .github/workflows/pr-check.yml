name: Pull Request Check

on:
  pull_request:
    branches: [ main, master ]
    types: [opened, synchronize, reopened]

jobs:
  pr-checks:
    name: PR Quality Checks
    runs-on: ubuntu-latest
    
    steps:
      - name: 📥 Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: 🟢 Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      - name: 📦 Install Dependencies (All Services)
        run: |
          cd student-service && npm ci && cd ..
          cd feedback-service && npm ci && cd ..
          cd admin-service && npm ci && cd ..
          cd frontend && npm ci && cd ..

      - name: 🏗️ Build All Services
        run: |
          echo "Building backend services..."
          cd student-service && npm run build || echo "No build script" && cd ..
          cd feedback-service && npm run build || echo "No build script" && cd ..
          cd admin-service && npm run build || echo "No build script" && cd ..
          echo "Building frontend..."
          cd frontend && npm run build

      - name: 📊 PR Summary
        run: |
          echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
          echo "✅ Pull Request Checks Passed!"
          echo "━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"
          echo ""
          echo "All services built successfully"
          echo "Ready for review and merge"